---
layout: single
title:  "[IC/ê°œë…] ì´ë¯¸ì§€ ë¶„ë¥˜ - DenseNet ğŸ•¸ï¸"
toc: true
toc_sticky: true
categories:
  - cv-imageclassification
---

## DenseNet ë…¼ë¬¸ ë¦¬ë·°

ì´ë²ˆ ê¸€ì—ì„œëŠ” [**<U>DenseNet ë…¼ë¬¸</U>**](https://arxiv.org/pdf/1608.06993.pdf)(Densenet, Densely Connected Convolutional Networks)ì„ ë¦¬ë·°í•œë‹¤.

### 1. Introduction

ë‹¹ì‹œ CNN ëª¨ë¸ë“¤ì˜ ê¹Šì´ê°€ ë” ê¹Šì–´ì§€ë©´ì„œ ìƒˆë¡œìš´ ì—°êµ¬ ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤. ë”°ë¼ì„œ ResNetì™€ ê°™ì´ input layerì™€ output layerê°€ directí•˜ê²Œ ì—°ê²°ë  ìˆ˜ ìˆëŠ” shorter connection ê°œë…ì— ì§‘ì¤‘í•˜ì—¬ íš¨ìœ¨ì ìœ¼ë¡œ trainí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°œì „í•˜ê³  ìˆë‹¤.

ì´ ë…¼ë¬¸ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ì¸µ ê°„ì˜ ì •ë³´ íë¦„ì„ ê·¹ëŒ€í™”í•˜ê¸° ìœ„í•´ì„œ **ëª¨ë“  ì¸µì„ ì„œë¡œ ì§ì ‘ ì—°ê²°í•˜ëŠ” ë°©ì‹ì„ ì œì•ˆ**í•œë‹¤. feed-forward ë³¸ì§ˆì„ ë³´ì¡´í•˜ê¸° ìœ„í•´ ê° ì¸µì€ ì„ í–‰í•˜ëŠ” ì¸µë“¤ë¡œë¶€í„° ì¶”ê°€ì ì¸ inputì„ ì–»ê³ , ìì²´ íŠ¹ì„±ë§µì„ ì´í›„ì˜ ëª¨ë“  ì¸µì— ì „ë‹¬í•œë‹¤. ResNetê³¼ëŠ” ë‹¬ë¦¬ featureê°€ ì¸µìœ¼ë¡œ ì „ë‹¬ë˜ê¸° ì „ì— í•©ì‚°ì„ í†µí•´ featureë¥¼ ê²°í•©í•˜ì§€ ì•Šê³ , **concatenationì„ ì‚¬ìš©í•´ì„œ ì—°ê²°**í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ **$L$ë²ˆì§¸ ì¸µì˜ feature mapì€ ì´í›„ $L-1$ê°œì˜ ëª¨ë“  ì¸µì„ í†µê³¼**í•œë‹¤. ì´ ê³¼ì •ìœ¼ë¡œ ì¸í•´ $L$-layer networkì—ëŠ” ì „í†µì ì¸ êµ¬ì¡°ê°€ $L$ê°œì˜ ì—°ê²°ì´ ì¡´ì¬í•˜ëŠ” ë°˜ë©´ì— **DenseNetì—ì„œëŠ” $(L(L+1))/2$ê°œì˜ ì—°ê²°ì´ ì¡´ì¬**í•˜ê²Œ ëœë‹¤.

![1](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/e7f6066d-a8c3-4f04-8444-cd36c1515a48)

ì´ëŸ¬í•œ DenseNetì€ ë‹¤ìŒì˜ ì¥ì ë“¤ì„ ê°–ëŠ”ë‹¤.

1. vanishing gradient ë°©ì§€
2. feature propagation ê°•í™”
3. feature reuse ê¶Œì¥
4. parameter ìˆ˜ ê°ì†Œ

### 2. Connectivity

ê·¸ëŸ¼ ResNetê³¼ DenseNetì˜ ì—°ê²°ì´ ì„œë¡œ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ì•Œì•„ë³´ì.

ë¨¼ì € ResNetì˜ connectivity ì‹ì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

![2](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/48717c53-e053-4ed5-8c9a-1f8af7e979dd)

$H_l(x_{l-1})$ì€ conv, bn, relu í•¨ìˆ˜ì˜ ì—°ì‚°ì„ ì˜ë¯¸í•˜ê³  $+x_{l-1}$ì€ skip connectionì— ì˜í•œ ë§ì…ˆì´ë‹¤. ì´ ê²½ìš°ì— layerì˜ ì…ë ¥ê°’ì´ ì¶œë ¥ê°’ì— ë”í•´ì ¸ gradient flowê°€ ì§ì ‘ì ìœ¼ë¡œ ì „ë‹¬ë˜ëŠ”ë°, **ë§ì…ˆìœ¼ë¡œ ê²°í•©ë˜ê¸° ë•Œë¬¸ì— ì‹ ê²½ë§ì—ì„œ ì •ë³´íë¦„ì´ ì§€ì—°**ë  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.

ë‹¤ìŒì€ DenseNetì˜ connectivity ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

![3](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/3b0c0dab-3217-460b-80bb-81fe5714c0f7)

DenseNetì€ **ì´ì „ layerë¥¼ ëª¨ë“  ë‹¤ìŒ layerì— concatenationì„ í†µí•´ì„œ ì—°ê²°í•˜ê¸° ë•Œë¬¸ì— ì •ë³´ íë¦„ì´ í–¥ìƒ**ëœë‹¤ê³  í•œë‹¤. 

ë‘ connectivityë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë¹„êµí•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

![4](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/b7cc2b89-5dec-428c-b9c2-61613ad93ef4)

ì™¼ìª½ì€ ResNetì—°ê²°ì´ê³ , ì˜¤ë¥¸ìª½ì€ DenseNetì—°ê²°ì´ë‹¤.

ë‘˜ ë‹¤ basic blockì´ë¼ê³  ê°€ì •í–ˆì„ ë•Œ, resnetì€ inputê³¼ outputì˜ channelì´ ê°™ì§€ë§Œ, **DenseNetì€ output feature mapì˜ channelì´ ë” ì»¤ì§„ë‹¤**. 



### 3. Dense Blockì˜ êµ¬ì¡°

![5](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/9f0edb8a-a5bf-408c-a0aa-b4e061164d22)

Dense Blockì˜ êµ¬ì¡°ëŠ” ìœ„ ì´ë¯¸ì§€ì™€ ê°™ë‹¤.

2)ì—ì„œ ë‹¤ë£¬ Dense Connection ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ê° layerë¥¼ ì—°ê²°í•˜ëŠ”ë°, ì—¬ê¸°ì„œ **ê° dense blockì—ì„œ ëª‡ ê°œì˜ feature mapì„ ë½‘ì„ ì§€ ê²°ì •í•˜ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„° Growth rate $k$**ëŠ”, ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„°ì˜ ìˆ˜ì— ì§ì ‘ì ì¸ ì˜í–¥ì„ ê°–ëŠ”ë‹¤. ìœ„ figure 1ì˜ ê²½ìš° $k=4$ë¥¼ ì˜ˆë¡œ ë“  ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì›ë˜ëŠ” ê¹Šì´ê°€ ê¹Šì–´ì§ˆìˆ˜ë¡ conv block í•œë²ˆì— ìƒë‹¹íˆ ë§ì€ ê°œìˆ˜ì˜ feature mapì„ ë½‘ì§€ë§Œ, ë…¼ë¬¸ì—ì„œëŠ” blockë§ˆë‹¤ $k=12$ë¡œ ì„¤ì •í•˜ì—¬ ì•„ì£¼ íš¨ìœ¨ì ì¸ êµ¬ì¡°ë¼ê³  ì„¤ëª…í•œë‹¤.

ResNetê³¼ ë§ˆì°¬ê°€ì§€ë¡œ **ë°˜ë“œì‹œ ê°™ì€ ì‚¬ì´ì¦ˆì˜ feature mapë¼ë¦¬ connectionì´ ê°€ëŠ¥**í•˜ê³ , ë§ˆì§€ë§‰ **Dense blockìœ¼ë¡œ outputì´ ë‚˜ì˜¤ë©´ figure 1 ëì— ë³´ì´ëŠ” Transition layerë¡œ ì§„ì…**í•œë‹¤.

Transition layerëŠ” (1x1 conv -> 2x2 avgPooling(stride=2))ë¡œ êµ¬ì„±ë¼ìˆë‹¤. **Dense blockì—ì„œëŠ” down samplingì´ ë¶ˆê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— 1x1 convë¡œ ì¼ë‹¨ featureë“¤ì„ í•œë²ˆ ì •ë¦¬í•´ì£¼ê³ , avgPoolingì„ í†µí•´ ë°˜ìœ¼ë¡œ sizeë¥¼ ì¤„ì´ëŠ” ì—­í• **ì„ í•œë‹¤.

$Î¸$ë¼ëŠ” $0<Î¸â‰¤1$ ê°’ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ê°€ ì¡´ì¬í•˜ëŠ”ë°, Dense blockì—ì„œ $m$ê°œì˜ feature mapì„ ë°›ì•˜ë‹¤ë©´, transition layerê°€ ì¶œë ¥í•˜ëŠ” feature map ê°œìˆ˜ë¥¼ ì¡°ì •í•˜ëŠ” ì¸ìë¡œ, $m$ x $Î¸$ë¡œ ì¶œë ¥ channelì„ ì¡°ì •í•œë‹¤. ì¦‰, **transition layerëŠ” feature mapì˜ í¬ê¸°ì™€ channel ìˆ˜ë¥¼ ê°ì†Œì‹œí‚¤ëŠ” ì—­í• **ì„ í•˜ëŠ” ê²ƒì´ë‹¤. ë…¼ë¬¸ì—ì„œëŠ” $Î¸=0.5$ë¡œ ë‘ê³  ì‹¤í—˜ì„ ì§„í–‰í–ˆë‹¤ê³  í•œë‹¤.

### 4. DenseNetì˜ êµ¬ì¡°

Dense blockê³¼ Transition layerë¥¼ ê²°í•©í•˜ì—¬ ìµœì¢…ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ DenseNet architectureê°€ ë§Œë“¤ì–´ì§„ë‹¤.

![6](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/4703ab41-c24a-498f-8677-8a758902496f)

ImageNet ë°ì´í„°ì…‹ì€ ìŠ¤ì¼€ì¼ì´ êµ‰ì¥íˆ í¬ê¸° ë•Œë¬¸ì— ë‹¤ìŒ table 1ì˜ architectureë¡œ ì‹¤í—˜ì„ ì§„í–‰í–ˆë‹¤.

![7](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/2d64739a-1836-4d07-afa1-4274929b7648)

DenseNet-121ì„ ë³´ë©´, growth rate $k$ë¥¼ 32ë¡œ ì„¤ì •í•˜ê³ , ê° dense blockë§ˆë‹¤ conv blockì´ 2ê°œì”© ìˆê¸° ë•Œë¬¸ì— layer ìˆ˜ë¥¼ ì„¸ë³´ë©´, 2 x (6 + 12 + 24 + 16) = 116 layerì— ê°€ì¥ ìƒë‹¨ì˜ 7x7 conv layer 1ê°œì™€ transition layerì˜ 1x1 conv layer 3ê°œì™€ ìµœí•˜ë‹¨ì˜ 1000D fc layer 1ê°œê¹Œì§€ í•´ì„œ 121 layer architectureì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

ë˜í•œ ResNetê³¼ íŒŒë¼ë¯¸í„° ìˆ˜ì™€ ì„±ëŠ¥ì„ ë¹„êµí–ˆì„ ë•Œ ë” ì ì€ íŒŒë¼ë¯¸í„° ìˆ˜ì™€ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì´ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

![8](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/527d0c2c-88df-4a9d-a8e6-93f5ec220d00)

![9](https://github.com/Hamin-Chang/Hamin-Chang.github.io/assets/77332628/0ab6ff66-a757-41e3-a402-d3548beaf3c9)

ì¶œì²˜ ë° ì°¸ê³ ë¬¸í—Œ:

1. https://arxiv.org/pdf/1608.06993.pdf
2. https://deep-learning-study.tistory.com/528
3. https://csm-kr.tistory.com/10



