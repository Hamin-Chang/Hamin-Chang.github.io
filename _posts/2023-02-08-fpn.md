---
title : '[DL/CV] ê°ì²´ íƒì§€ - FPN ğŸ¥ª'
layout : single
toc : true
toc: true
toc_sticky: true
categories:
  - cv-objectdetection
---

## FPN (Feature Pyramid Networks for Object Detection) ì½ì–´ë³´ê¸°

ì´ë²ˆ ê¸€ì—ì„œëŠ” FPN ë…¼ë¬¸([**ë§í¬**](https://arxiv.org/pdf/1612.03144.pdf))ì„ ë¦¬ë·°í•´ë³´ë„ë¡ í•˜ê² ë‹¤. ì´ë¯¸ì§€ ë‚´ ì¡´ì¬í•˜ëŠ” ë‹¤ì–‘í•œ í¬ê¸°ì˜ ê°ì²´ë¥¼ ì¸ì‹í•˜ëŠ” ê²ƒì€ Object detection taskì˜ í•µì‹¬ì ì¸ ë¬¸ì œë‹¤.

### 0. ê¸°ì¡´ì˜ ë°©ì‹

ë‹¤ì–‘í•œ í¬ê¸°ì˜ ê°ì²´ë¥¼ detectí•˜ë„ë¡ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ì‹œë„ê°€ ìˆì—ˆë‹¤. ê¸°ì¡´ì˜ ë°©ì‹ë“¤ê³¼ ê°ê°ì˜ ë¬¸ì œì ì„ ì‚´í´ë³´ì.

![1](https://user-images.githubusercontent.com/77332628/217481799-80782b4b-a3c9-4673-9f85-5f5481ebd54d.jpeg)

(a) Featurized image pyramid

ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ë¥¼ resizeí•´ì„œ ë‹¤ì–‘í•œ scaleì˜ ì´ë¯¸ì§€ë¥¼ ë„¤íŠ¸ì›Œí¬ì— ì…ë ¥í•˜ëŠ” ë°©ë²•ì´ë‹¤. Overfeat ëª¨ë¸ í•™ìŠµ ì‹œ í•´ë‹¹ ë°©ë²•ì„ ì‚¬ìš©í–ˆê³ , ë‹¤ì–‘í•˜ í¬ê¸°ì˜ ê°ì²´ë¥¼ í¬ì°©í•˜ëŠ”ë° ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤. í•˜ì§€ë§Œ ì´ë¯¸ì§€ í•œì¥ í•œì¥ì„ ë…ë¦½ì ìœ¼ë¡œ ëª¨ë¸ì— ì…ë ¥í•´ì„œ feature mapì„ ìƒì„±í•˜ê¸° ë•Œë¬¸ì— ì¶”ë¡  ì†ë„ê°€ ëŠë¦¬ë‹¤ëŠ” ë¬¸ì œì ì´ ìˆë‹¤.

(b) Singe feature map

YOLO v1ì—ì„œ ì‚¬ìš©í•œ ë°©ë²•ìœ¼ë¡œ, ë‹¨ì¼ scaleì˜ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ë„¤íŠ¸ì›Œí¬ì— ì…ë ¥í•´ì„œ ë‹¨ì¼ scaleì˜ feature mapì„ í†µí•´ object detectionì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì´ë‹¤. í•™ìŠµ ë° ì¶”ë¡  ì†ë„ê°€ ë§¤ìš° ë¹ ë¥´ì§€ë§Œ ì„±ëŠ¥ì´ ë–¨ì–´ì§€ëŠ” ë¬¸ì œì ì´ ìˆë‹¤. 

(c) Pyramid feature hierarchy

SSD ëª¨ë¸ì—ì„œ ì‚¬ìš©í•œ ë°©ë²•ìœ¼ë¡œ, ë„¤íŠ¸ì›Œí¬ì—ì„œ ë¯¸ë¦¬ ì§€ì •í•œ conv layerë§ˆë‹¤ feature mapì„ ì¶”ì¶œí•´ì„œ detectí•˜ëŠ” ë°©ë²•ì´ë‹¤. multi-scale feature mapì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ì´ ë†’ì§€ë§Œ feature map ê°„ì˜ í•´ìƒë„ ì°¨ì´ë¡œ ì¸í•´ì„œ í•™ìŠµí•˜ëŠ” representationì—ì„œì˜ ì°¨ì´ì¸ semantic gapì´ ë°œìƒí•œë‹¤ëŠ” ë¬¸ì œì ì´ ìˆë‹¤. ëª¨ë¸ì´ ì–•ì€ layerì—ì„œ ì¶”ì¶œí•œ feature mapì—ì„œ ì €ìˆ˜ì¤€(low-level) featureê¹Œì§€ í•™ìŠµí•˜ë©´ representational capacityë¥¼ ì†ìƒì‹œì¼œì„œ ê°ì²´ ì¸ì‹ë¥ ì´ ë‚®ì•„ì§„ë‹¤ê³  í•œë‹¤.

SSDëŠ” ì´ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ low-level featureì´ ì•„ë‹Œ ì „ì²´ convolutional network ì¤‘ê°„ ì§€ì ë¶€í„° feature mapì„ ì¶”ì¶œí•˜ì§€ë§Œ, FPN ë…¼ë¬¸ì˜ ì €ìëŠ” ë†’ì€ í•´ìƒë„ì˜ feature mapì€ ì‘ì€ ê°ì²´ë¥¼ detectí•  ë•Œ ìœ ìš©í•˜ê¸° ë•Œë¬¸ì— ì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ë¶€ì ì ˆí•˜ë‹¤ê³  ì§€ì í•œë‹¤.

### 1. Pyramidë€?

ë³¸ ë…¼ë¬¸ì€ FPNì„ í†µí•´ì„œ ì»´í“¨í„° ìì›ì„ ì ê²Œ ì°¨ì§€í•˜ê³  ê¸°ì¡´ ë°©ì‹ë“¤ì˜ ë¬¸ì œì ì„ í•´ê²°í•œ ë‹¤ì–‘í•œ í¬ê¸°ì˜ ê°ì²´ë¥¼ ì¸ì‹í•˜ëŠ” ë°©ë²•ì„ ì œì‹œí•œë‹¤. FPNì˜ í•µì‹¬ ì•„ì´ë””ì–´ë¥¼ ì•Œì•„ë³´ê¸° ì „ì— ë³¸ ë…¼ë¬¸ì—ëŠ” **"Pyramid"**ë¼ëŠ” ë‹¨ì–´ê°€ ìì£¼ ë“±ì¥í•˜ëŠ”ë°, ì´ëŠ” ë‹¤ìŒ ì´ë¯¸ì§€ì²˜ëŸ¼ convolutional networkì—ì„œ ì–»ì„ ìˆ˜ ìˆëŠ” ì„œë¡œ ë‹¤ë¥¸ í•´ìƒë„ì˜ feature mapì„ ìŒ“ì•„ì˜¬ë¦° í˜•íƒœë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.


![2](https://user-images.githubusercontent.com/77332628/217481809-8294fced-af18-4f61-9b35-d65ab887a9d2.png)

ê·¸ë¦¬ê³  **level**ì€ í”¼ë¼ë¯¸ë“œì˜ ê° ì¸µì— í•´ë‹¹í•˜ëŠ” feature mapì´ë‹¤. convolutional networkì—ì„œ ë” ì–•ì€, ì¦‰ ì…ë ¥ì¸µì— ê°€ê¹Œìš¸ìˆ˜ë¡ feature mapì€ ë†’ì€ í•´ìƒë„(high resolution)ì„ ê°–ê³ , ê°€ì¥ìë¦¬, ê³¡ì„  ë“±ê³¼ ê°™ì€ ì €ìˆ˜ì¤€ íŠ¹ì§•(low-level feature)ì„ ê°€ì§„ë‹¤. ë°˜ëŒ€ë¡œ ë” ê¹Šì€ layerì—ì„œ ì–»ì„ ìˆ˜ ìˆëŠ” feature mapì€ ë‚®ì€ í•´ìƒë„(low-level resolution)ì„ ê°€ì§€ë©°, ì§ˆê°ê³¼ ë¬¼ì²´ì˜ ì¼ë¶€ë¶„ ë“± classë¥¼ ì¶”ë¡ í•  ìˆ˜ ìˆëŠ” ê³ ìˆ˜ì¤€ íŠ¹ì§•(high-level feature)ì„ ê°€ì§€ê³  ìˆë‹¤.

![3](https://user-images.githubusercontent.com/77332628/217481811-4d728b3f-5f44-4e67-aaa6-547d1a81a2eb.png)

Object detection ëª¨ë¸ì€ í”¼ë¼ë¯¸ë“œì˜ ê° levelì˜ feature mapì„ ì¼ë¶€ í˜¹ì€ ì „ë¶€ ì‚¬ìš©í•´ì„œ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•œë‹¤. ì´ ë¶€ë¶„ì„ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•˜ë©´ FPN ëª¨ë¸ì„ ì¡°ê¸ˆ ë” ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.





### 2. Main Ideas

**Feature Pyramid Network**

![4](https://user-images.githubusercontent.com/77332628/217481818-30a3c685-0452-46f5-8ffb-efd4a1434535.png)

Feature Pyramid NetworkëŠ” ì„ì˜ì˜ single-scale ì´ë¯¸ì§€ë¥¼ convolutional networkì— ì…ë ¥í•´ì„œ ë‹¤ì–‘í•œ scaleì˜ feature mapì„ ì¶œë ¥í•˜ëŠ” networkì´ë‹¤. FPNì€ ì™„ì „ ìƒˆë¡­ê²Œ ì„¤ê³„ëœ ëª¨ë¸ì€ ì•„ë‹ˆê³  ê¸°ì¡´ convolutional networkì—ì„œ ì§€ì •í•œ layerë³„ë¡œ feature mapì„ ì¶”ì¶œí•´ì„œ ìˆ˜ì •í•˜ëŠ” networkë¼ê³  í•  ìˆ˜ ìˆë‹¤. FPNì´ feature mapì„ ì¶”ì¶œí•´ì„œ í”¼ë¼ë¯¸ë“œë¥¼ ê±´ì¶•í•˜ëŠ” ê³¼ì •ì€ **1) bottom - up pathway**, **2) top - down pathway, lateral connection**ì— ë”°ë¼ ì§„í–‰ëœë‹¤.

1) **Bottom - up pathway**

![5](https://user-images.githubusercontent.com/77332628/217481822-497d4e47-e48e-4386-acc4-3d1c5540f3c5.png)

"ìƒí–¥ì‹ ê³¼ì •"ì´ë¼ê³ ë„ í•˜ëŠ” Bottom - up pathwayëŠ” ì´ë¯¸ì§€ë¥¼ convolutional networkì— ì…ë ¥í•´ì„œ forward passí•´ì„œ 2ë°°ì”© ì‘ì•„ì§€ëŠ” feature mapì„ ì¶”ì¶œí•˜ëŠ” ê³¼ì •ì´ë‹¤. ìœ„ ì´ë¯¸ì§€ì²˜ëŸ¼ ê° **stage**ì˜ ë§ˆì§€ë§‰ layerì˜ output feature mapì„ ì¶”ì¶œí•˜ëŠ”ë°, ë…¼ë¬¸ì—ì„œëŠ” ê°™ì€ í¬ê¸°ì˜ feature mapì„ ì¶œë ¥í•˜ëŠ” layerë¥¼ ëª¨ë‘ ê°™ì€ **stage**ì— ì†í•´ìˆë‹¤ê³  ì •ì˜í•œë‹¤. ê° stageë³„ë¡œ ë§ˆì§€ë§‰ layerë¥¼ pyramid layerë¡œ ì§€ì •í•˜ëŠ” ì´ìœ ëŠ” ë” ê¹Šì€ layerê°€ ë” ê°•ë ¥í•œ featureë¥¼ ë³´ìœ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ë³¸ ë…¼ë¬¸ì—ì„œëŠ” convolutional networkë¥¼ ResNetì„ ì‚¬ìš©í•˜ëŠ”ë°, ì´ ê²½ìš° ë§ˆì§€ë§‰ residual blockì˜ output feature mapì„ í™œìš©í•´ì„œ feature pyramidë¥¼ êµ¬ì„±í•˜ëŠ”ë° ê° outputì„ {c2, c3, c4, c5}ë¼ê³  ì§€ì •í•œë‹¤. ì´ëŠ” ê°ê° {4, 8, 16, 32} strideë¥¼ ê°€ì§€ê³  ìˆì–´ì„œ ê°ê°ì€ ì›ë³¸ ì´ë¯¸ì§€ì˜ 1/4, 1/8, 1/16, 1/32 í¬ê¸°ë¥¼ ê°€ì§„ feature mapì´ë‹¤. c1ì´ ì—†ëŠ” ì´ìœ ëŠ” conv1ì˜ output feature mapì€ ë„ˆë¬´ ë§ì€ ë©”ëª¨ë¦¬ë¥¼ ì°¨ì§€í•˜ê¸° ë•Œë¬¸ì— í”¼ë¼ë¯¸ë“œì—ì„œ ì œì™¸ë˜ì—ˆë‹¤ê³  í•œë‹¤.

2) **Top - down pathway + Lateral connections**


![6](https://user-images.githubusercontent.com/77332628/217481826-4b4cebbb-d337-4dda-b4d5-f74a27a22b1c.png)

Top - down PathwayëŠ” ê° pyramid levelì— ìˆëŠ” feature mapì„ 2ë°°ë¡œ upsamplingí•˜ê³  channel ìˆ˜ë¥¼ ë™ì¼í•˜ê²Œ ë§ì¶°ì£¼ëŠ” ê³¼ì •ì´ë‹¤. ê° pyramid level feature mapì„ 2ë°°ë¡œ upsamplingí•´ì£¼ë©´ ë°”ë¡œ ì•„ë˜ levelì˜ feature mapê³¼ í¬ê¸°ê°€ ê°™ì•„ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ c3ë¥¼ upsamplingí•˜ë©´ c2ì™€ í¬ê¸°ê°€ ê°™ì•„ì§„ë‹¤. upsamplingì€ **nearest neighbor upsampling** ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. 

![7](https://user-images.githubusercontent.com/77332628/217481827-8ca2fabb-d4f9-4b44-8368-fe20eced6c8b.png)

ì´í›„ ëª¨ë“  pyramid levelì˜ feature mapì— 1x1 conv ì—°ì‚°ì„ ì ìš©í•´ì„œ channelì„ 256ìœ¼ë¡œ ë§ì¶°ì¤€ë‹¤. ê·¸ë¦¬ê³  upsampleëœ feature mapê³¼ ë°”ë¡œ ì•„ë˜ levelì˜ feature mapê³¼ element-wise additionì„ í•˜ëŠ” Later connection ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤.

![8](https://user-images.githubusercontent.com/77332628/217481829-68ca4b64-309a-4fdb-93db-f21b9bb4fbd7.png)

Lateral connection ê³¼ì •ì„ ê±°ì¹œ í›„ ê°ê°ì˜ feature mapì— 3x3 conv ì—°ì‚°ì„ ì ìš©í•´ì„œ ì–»ì€ feature mapì´ ê°ê° {p2, p3, p4, p5}ì´ë‹¤. ì´ëŠ” ê°ê° {c2, c3, c4, c5}ì™€ í¬ê¸°ê°€ ê°™ë‹¤. ê°€ì¥ ë†’ì€ levelì— ìˆëŠ” feature map c5ì˜ ê²½ìš° 1x1 conv ì—°ì‚° í›„ ê·¸ëŒ€ë¡œ ì¶œë ¥í•´ì„œ p5ë¥¼ ì–»ëŠ”ë‹¤. ì°¸ê³ ë¡œ ì—¬ê¸°ì„œ 3x3 conv ì—°ì‚°ì„ ì ìš©í•˜ëŠ” ì´ìœ ëŠ” upsamplingëœ layerì™€ ë³‘í•©ë  ë•Œ ì—˜ë¦¬ì–´ì‹± íš¨ê³¼ë¥¼ ì¤„ì´ê¸° ìœ„í•´ì„œì´ë‹¤.

![9](https://user-images.githubusercontent.com/77332628/217481833-282cdfe6-3a6f-4e42-a8c5-860edb5b10f3.png)

ìœ„ ê³¼ì •ì„ í†µí•´ì„œ FPNì€ single-scale ì´ë¯¸ì§€ë¥¼ ì…ë ¥í•´ì„œ 4ê°œì˜ multi-scale feature mapì„ ì–»ëŠ”ë‹¤. ì´ ë°©ì‹ì´ SSDì—ì„œ ì‚¬ìš©í•œ (c) ë°©ì‹ë³´ë‹¤ ë‚˜ì€ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. Detection taskì‹œ ê³ í•´ìƒë„ feature mapì€ low-level featureë¥¼ ê°€ì§€ì§€ë§Œ ê°ì²´ì˜ ìœ„ì¹˜ì— ëŒ€í•œ ì •ë³´ë¥¼ ìƒëŒ€ì ìœ¼ë¡œ ë³´ì¡´í•˜ê³  ìˆë‹¤. ì´ëŠ” ì €í•´ìƒë„ feature mapì— ë¹„í•´ ëœ downsample ëê¸° ë•Œë¬¸ì´ë‹¤. ì´ëŸ¬í•œ ê³ í•´ìƒë„ feature mapì˜ íŠ¹ì§•ì„ element-wise additionì„ í†µí•´ ì €í•´ìƒë„ feature mapì— ì „ë‹¬í•˜ê¸° ë•Œë¬¸ì— (c) ë°©ì‹ë³´ë‹¤ ì‘ì€ ê°ì²´ë¥¼ ë” ì˜ detect í•œë‹¤.




### 3. Training ResNet + Faster R-CNN with FPN


![10](https://user-images.githubusercontent.com/77332628/217481840-02abedf4-4c67-4bd1-be47-f0d2350932b5.png)

ë…¼ë¬¸ì—ì„œëŠ” ResNetì„ backbone networkë¡œ ì‚¬ìš©í•˜ëŠ” Faster R-CNNì— FPNì„ ì ìš©í•´ì„œ í•™ìŠµì‹œí‚¤ëŠ” ê³¼ì •ì„ ì„¤ëª…í•œë‹¤. 

1) **Build Feature Pyramid by FPN**

FPNì€ ê·¸ ìì²´ë¡œ ê°ì²´ íƒì§€ê¸°ê°€ ì•„ë‹ˆë¼ ê°ì²´ íƒì§€ê¸°ì™€ í•¨ê»˜ ì‘ë™í•˜ëŠ” feature ì¶”ì¶œê¸°ì´ë‹¤. FPNì€ feature mapì„ ì¶”ì¶œí•˜ê³  ë‚˜ì¤‘ì— ê°ì²´ íƒì§€ë¥¼ ìœ„í•´ íƒì§€ê¸°ì— ê³µê¸‰í•œë‹¤. ë¨¼ì € FPNìœ¼ë¡œ feature ì¶”ì¶œì„ í•´ë³´ì.

ResNet ê¸°ë°˜ì˜ FPNì— ì›ë³¸ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ì…ë ¥í•˜ê³  Bottom-up pathwayë¥¼ ê±°ì³ì„œ ì›ë³¸ ì´ë¯¸ì§€ì˜ 1/4, 1/8, 1/16, 1/32 í¬ê¸°ì— í•´ë‹¹í•˜ëŠ” feature map {c2, c3, c4, c5}ì„ ì¶œë ¥í•˜ê³ , ì´ë¥¼ Top-down pathway ê³¼ì •ì„ í†µí•´ì„œ 1x1 convë¥¼ ì ìš©í•´ì„œ channel ìˆ˜ë¥¼ 256ìœ¼ë¡œ ë§ì¶”ê³  í¬ê¸°ë¥¼ 2ë°° upsamplingí•œë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ Lateral connectionsë¥¼ í†µí•´ ê° feature mapì„ ë°”ë¡œ ì•„ë˜ pyramid levelì— ì¡´ì¬í•˜ëŠ” feature mapê³¼ element-wise additionì„ ìˆ˜í–‰í•˜ê³  3x3 convë¥¼ ì ìš©í•´ì„œ  {p2, p3, p4, p5} feature mapì„ ì¶œë ¥í•œë‹¤.

* Input : single-scale image
* Process : build feature pyramid by FPN
* Output : multi-scale feature map {p2, p3, p4, p5} 

2) **Class score and Bounding box by RPN**

![11](https://user-images.githubusercontent.com/77332628/217481847-b5044668-1478-4d7c-9f70-280846a1a6e8.jpeg)

(1)ê³¼ì •ì—ì„œ ì–»ì€ feature map {p2, p3, p4, p5}ë¥¼ RPN(Region Proposal Network)ì— ì…ë ¥í•œë‹¤. ê° pyramid levelì˜ feature mapì— ëŒ€í•´ 3x3 conv ì—°ì‚°ì´ ì ìš©ëœ ë‹¤ìŒ class scoreê³¼ bounding box regressor ì¶œë ¥ì„ ìœ„í•´ ë³„ë„ì˜ 1x1 conv ì—°ì‚°ì´ ì ìš©ëœë‹¤. ì´ëŸ¬í•œ 3x3 ë° 1x1 conv layerë¥¼ RPN *head*ë¼ê³  í•œë‹¤. ì´í›„ Non maximum suppression ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•´ì„œ class scoreê°€ ë†’ì€ ìƒìœ„ 1000ê°œì˜ region proposalë§Œì„ ì¶œë ¥í•œë‹¤.

* Input :  multi-scale feature map {p2, p3, p4, p5}
* Process : region proposal and Non maximum suppression
* Output : 1000 region proposals

3) **Max pooling by RoI pooling**

(1)ì—ì„œ ì–»ì€ multi-scale feature map {p2, p3, p4, p5}ì™€ (2)ì—ì„œ ì–»ì€ 1000ê°œì˜ region proposalsë¥¼ ì‚¬ìš©í•´ì„œ RoI poolingì„ ìˆ˜í–‰í•œë‹¤. FPNì„ ì ìš©í•œ Faster R-CNNì€ multi-scale feature mapì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— **RoIë¥¼ ì–´ë–¤ scaleì˜ feature mapê³¼ ë§¤ì¹­**ì‹œí‚¬ì§€ë¥¼ ê²°ì •í•´ì•¼í•œë‹¤.

![12](https://user-images.githubusercontent.com/77332628/217481858-064929c7-d1e5-4341-9147-2b043b744d91.png)

ë…¼ë¬¸ì—ì„œëŠ” ìœ„ì™€ ê°™ì€ ê³µì‹ì„ ì‚¬ìš©í•´ì„œ RoIë¥¼ $k$ë²ˆì§¸ feature mapê³¼ ë§¤ì¹­í•œë‹¤. ìœ„ ì‹ì—ì„œ $w, h$ëŠ” ê°ê° RoIì˜ ë„ˆë¹„, ë†’ì´ì— í•´ë‹¹í•˜ê³ , $k$ëŠ” pyramid levelì˜ index, $k_0$ì€ target levelì„ ì˜ë¯¸í•œë‹¤. ($k_0=4$ë¡œ ë…¼ë¬¸ì—ì„œëŠ” ì§€ì •) ì§ê´€ì ìœ¼ë¡œ ë´¤ì„ ë•Œ RoIì˜ scaleì´ ì‘ì•„ì§ˆìˆ˜ë¡ ë‚®ì€ pyramid level, ì¦‰ í•´ìƒë„ê°€ ë†’ì€ feature mapì— í• ë‹¹ë¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

* Input : multi-scale feature map {p2, p3, p4, p5}, 1000 region proposals
* Process : RoI pooling
* Output : fixed sized feature maps


4) Train Faster R-CNN 

RoI poolingì„ í†µí•´ ì–»ì€ fixed sized feature mapsë¥¼ Fast R-CNNì— ì…ë ¥í•œ í›„ ì „ì²´ ë„¤íŠ¸ì›Œí¬ë¥¼ multi-task loss functionì„ í†µí•´ í•™ìŠµì‹œí‚¨ë‹¤. ì†ì‹¤í•¨ìˆ˜ì™€ ìœ„ì˜ RoI poolingì— ëŒ€í•œ ë‚´ìš©ì€ [<U>**Fast R-CNN ë…¼ë¬¸ ë¦¬ë·°**</U>](https://hamin-chang.github.io/cv-objectdetection/frcnn/)ë¥¼ ì°¸ê³ í•˜ë©´ ëœë‹¤.


### 4. Detection & ê²°ë¡ 

ì‹¤ì œ inference ì‹œì—ëŠ” Fast R-CNNì˜ ë§ˆì§€ë§‰ ì˜ˆì¸¡ì— Non maximum suppressionì„ ì ìš©í•´ì„œ ìµœì ì˜ ì˜ˆì¸¡ ê²°ê³¼ë§Œì„ ì¶œë ¥í•œë‹¤.

ResNetì„ backbone networkë¡œ ì‚¬ìš©í•œ Faster R-CNNì— FPNì„ ê²°í•©ì‹œì¼°ì„ ë•Œ, FPNì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œë³´ë‹¤ AP ê°’ì´ 8% ì´ìƒ í–¥ìƒë˜ì—ˆë‹¤ê³  í•œë‹¤. ì´ì™¸ì—ë„ FPNì€ end-to-endë¡œ í•™ìŠµì´ ê°€ëŠ¥í•˜ë©°, í•™ìŠµ ë° í…ŒìŠ¤íŠ¸ ì‹œê°„ì´ ì¼ì •í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ì ë‹¤ëŠ” ì¥ì ì„ ê°€ì§€ê³  ìˆë‹¤. 
 
FPN ë…¼ë¬¸ ë¦¬ë·°ë¥¼ í†µí•´ì„œ feature mapì˜ ì—­í• ê³¼ íŠ¹ì§•ì„ ë‹¤ì‹œ í•œë²ˆ ì§šê³  ë„˜ì–´ê°ˆ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤. FPNì˜ lateral-connection ë¶€ë¶„ì´ ResNetì˜ skip connectionì˜ ê°œë…ê³¼ ë¹„ìŠ¤í•œ ëŠë‚Œì´ ë“¤ì—ˆë‹¤. 

ì¶œì²˜ ë° ì°¸ê³ ë¬¸í—Œ 

FPN ë…¼ë¬¸ (https://arxiv.org/pdf/1612.03144.pdf)

ê°œì¸ ë¸”ë¡œê·¸ (http://herbwood.tistory.com/18)

wikidocs (https://wikidocs.net/162976)



